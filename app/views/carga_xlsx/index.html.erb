<h1>Carga y VisualizaciÃ³n XLSX ðŸ“Š</h1>

<% if flash[:notice] %>
  <div style="color: green;"><%= flash[:notice] %></div>
<% end %>
<% if flash[:alert] %>
  <div style="color: red;"><%= flash[:alert] %></div>
<% end %>

<hr>

<%= turbo_frame_tag "resultados_carga" do %>

<h2>Subir archivo</h2>
  <%= form_with url: "/carga-xlsx/procesar", method: :post, multipart: true do |form| %>
    <div>
      <%= form.label :archivo_excel, "Selecciona un archivo .xlsx:" %>
      <%= form.file_field :archivo_excel, accept: ".xlsx" %>
    </div>
    <div style="margin-top: 10px;">
      <%= form.submit "Procesar Archivo" %>
    </div>
  <% end %>

  <hr>

  <h2>Datos Procesados</h2>

  <% if @curso && @division %>
    <p><strong>Curso:</strong> <%= @curso %></p>
    <p><strong>DivisiÃ³n:</strong> <%= @division %></p>
  <% end %>

  <% if @materias && @materias.any? %>
    <h3>Materias:</h3>
    <ul>
      <% @materias.each do |materia| %>
        <li><%= materia %></li>
      <% end %>
    </ul>
  <% end %>

  <% if @alumnos && @alumnos.any? %>
    <h3>Alumnos:</h3>
    <ul>
      <% @alumnos.each do |alumno| %>
        <li><%= alumno %></li>
      <% end %>
    </ul>
  <% end %>
  <% if @alumnos.nil? && @materias.nil? && @curso.nil? && @division.nil? %>
    <p>No hay datos para mostrar. Sube un archivo para comenzar.</p>
  <% end %>

<% end %>